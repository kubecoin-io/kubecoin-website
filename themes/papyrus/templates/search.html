{% extends "base.html" %}
{% block title %}Search - {{ SITENAME }}{% endblock %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" type="text/css" href="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/css/stork.css">
  <link rel="stylesheet" type="text/css" href="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/css/stork-dark.css">
  <style>
    /* Optional: Add some basic styling for the search page layout */
    .stork-wrapper {
      margin: 2em auto;
      max-width: 800px;
      padding: 0 1em;
    }
    .stork-input {
      width: 100%;
      padding: 0.75em 1em;
      font-size: 1.1em;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-bottom: 1em;
    }
    .stork-output {
      margin-top: 1em;
    }
    .stork-output ul {
      list-style-type: none;
      padding-left: 0;
    }
    .stork-output li {
      border-bottom: 1px solid #eee;
      padding: 0.75em 0;
    }
    .stork-output li:last-child {
      border-bottom: none;
    }
    .stork-output a {
      text-decoration: none;
      color: #333;
    }
    .stork-output a:hover {
      text-decoration: underline;
    }
    .stork-output .title {
      font-weight: bold;
      font-size: 1.1em;
      display: block;
      margin-bottom: 0.25em;
    }
    .stork-output .excerpt {
      font-size: 0.9em;
      color: #555;
    }
    /* Dark theme adjustments for Stork output if needed */
    .dark .stork-input {
        border-color: #555;
        background-color: #333;
        color: #f1f1f1;
    }
    .dark .stork-output a {
        color: #f1f1f1;
    }
    .dark .stork-output .excerpt {
        color: #aaa;
    }
    .dark .stork-output li {
        border-bottom-color: #444;
    }
  </style>
{% endblock %}

{% block content %}
<article class="prose dark:prose-invert max-w-none">
  <h1 class="text-center">Search</h1>
  <div class="stork-wrapper">
    <input data-stork="kubecoin-search" class="stork-input" placeholder="Enter search query...">
    <div data-stork="kubecoin-search-output" class="stork-output"></div>
  </div>
</article>

<script src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/js/stork.js"></script>
<script>
  stork.register('kubecoin-search', '{{ SITEURL }}/search-index.st', {
    showProgress: true,
    // Optional: Customize how results are displayed or handled
    // onQueryUpdate: (query, results) => {
    //     console.log(`Query: ${query}, Results:`, results);
    // },
    onResultSelected: (query, result) => {
        console.log(`Query: ${query}, Selected:`, result);
        window.location.assign(result.entry.url);
    },
    // Optional: if you want to show excerpts
    // showScores: true, 
    // minimumQueryLength: 3,
  });
</script>
{% endblock %}